# MEOS 输入输出格式

本文档详细说明 MEOS 平台的输入输出格式，是复刻的核心参考文档。

## 1. 输入文件格式

### 1.1 负荷曲线

**文件格式**: CSV/Excel

**文件命名**: `负荷曲线_<类型>_<区域>.csv`

**列结构**:

| 列名 | 类型 | 说明 |
|------|------|------|
| 时间 | int | 1-8760 小时索引 |
| 负荷 | float | 负荷值 (MW) |

**示例文件**:
- `负荷曲线_电_学生区.csv`
- `负荷曲线_热_教学办公区.csv`
- `负荷曲线_冷_教工区.csv`

### 1.2 可再生能源出力系数

**文件命名**: `出力曲线_<类型>.csv`

**列结构**:

| 列名 | 类型 | 说明 |
|------|------|------|
| 时间 | int | 1-8760 |
| 出力系数 | float | 0-1 标幺值 |

**示例文件**:
- `出力曲线_光伏.csv`
- `出力曲线_风电.csv`

### 1.3 价格数据

**文件命名**: `<价格类型>价格.csv`

**列结构**:

| 列名 | 类型 | 说明 |
|------|------|------|
| 时间 | int | 1-8760 |
| 价格 | float | 元/kWh 或 元/Nm³ |

**示例文件**:
- `电源价格_电.csv`
- `天然气价格.csv`

### 1.4 碳排放因子

**文件命名**: `<来源>碳排放因子.csv`

**列结构**:

| 列名 | 类型 | 说明 |
|------|------|------|
| 时间 | int | 1-8760 |
| 碳排放因子 | float | kg CO2/kWh |

## 2. 输出文件格式

### 2.1 MEOS 导出 Excel 结构

**工作表 1: 设备规划结果**

| 列名 | 说明 |
|------|------|
| 设备类型 | 设备名称 |
| 容量_MW | 安装容量 |
| 是否选型 | 1/0 |
| 年化投资 | 元/年 |

**工作表 2: 运行调度结果**

典型结构：

| 编号 | 时间 | 指标类型 | 枢纽 | 设备 | H1 | H2 | ... | H8760 |
|------|------|---------|------|------|----|----|-----|-------|
| 1 | - | 电网购电 | 全局 | - | xx | xx | ... | xx |
| 2 | - | 燃气消耗 | 全局 | - | xx | xx | ... | xx |
| 3 | - | 切电负荷 | 学生区 | - | xx | xx | ... | xx |
| ... | ... | ... | ... | ... | ... | ... | ... | ... |

### 2.2 关键指标映射

| MEOS 指标名 | 代码变量名 | 单位 | 说明 |
|------------|-----------|------|------|
| 电网购电功率(MW) | P_grid | MW | 从电网购电 |
| 气源出力(MW) | P_gas | MW | 天然气消耗 |
| 能量枢纽切电负荷量(MW) | P_shed_e | MW | 电负荷切除 |
| 能量枢纽切热负荷量(MW) | P_shed_h | MW | 热负荷切除 |
| 能量枢纽切冷负荷量(MW) | P_shed_c | MW | 冷负荷切除 |
| 光伏出力(MW) | P_pv | MW | 光伏发电 |
| 风电出力(MW) | P_wind | MW | 风电发电 |
| CHP发电(MW) | P_chp_e | MW | CHP 电力输出 |
| CHP供热(MW) | P_chp_h | MW | CHP 热力输出 |
| 储电充电(MW) | P_batt_ch | MW | 电池充电 |
| 储电放电(MW) | P_batt_dis | MW | 电池放电 |
| 储电SOC | SOC_batt | - | 电池荷电状态 |

### 2.3 成本汇总

| 项目 | 说明 |
|------|------|
| 年化投资成本 | 设备投资等年值 |
| 购电成本 | 电网购电费用 |
| 购气成本 | 天然气购买费用 |
| 失负荷惩罚 | 切负荷罚款 |
| 碳成本 | 超标碳排放费用 |
| 总成本 | 以上各项之和 |

## 3. OJ 提交格式

### 3.1 文件命名

`HWdata_for_OJ.csv`

### 3.2 数据结构

由 `MEHW_data_reshape.m` 脚本生成，包含：

1. **设备容量部分** (前若干行)
   - 各设备的安装容量

2. **时序数据部分** (8760 行)
   - 电网购电
   - 燃气消耗
   - 各类切负荷

### 3.3 校验规则

- 总行数：8760 + 设备容量行数
- 所有数值非负
- 无 NaN/Inf 值
- 切负荷量尽可能为 0

## 4. 格式转换流程

```
MEOS 导出 Excel
      |
      v
MEHW_data_reshape.m (或 reshape_for_oj.m)
      |
      v
HWdata_for_OJ.csv
      |
      v
OJ 平台提交
```
