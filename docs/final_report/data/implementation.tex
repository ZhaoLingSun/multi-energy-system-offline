\section{工程实现与软件架构}

本研究的工程实现围绕"模型构建—优化求解—格式导出—评分复算"四个核心模块构建完整的求解链路。

\subsection{核心模块}

\begin{itemize}
\item \textbf{模型构建}：核心入口为 \path{python/scripts/run_full_milp.py}，负责读取输入数据、构建 MILP 模型并调用 Gurobi 求解器。

\item \textbf{分区调度}：调度逻辑封装于 \path{python/meos/dispatch/zonal_dispatcher.py} 模块，实现了三区域能量平衡、储能状态演化与设备出力约束的统一建模。

\item \textbf{格式导出}：OJ 格式导出由 \path{python/meos/export/oj_exporter.py} 实现，支持 CSV 与 XLSX 双格式输出。

\item \textbf{评分复算}：评分复算由 \path{python/scripts/score_oj_csv.py} 完成，实现了与 OJ 评分系统一致的 Logistic 映射函数。

\item \textbf{平台验证}：平台 Excel 格式的转写与验证逻辑固化于 \path{python/scripts/verify_platform_export.py}，确保导出结果与评分在统一口径下可完整复现。
\end{itemize}

\subsection{数据流}

图~\ref{fig:architecture}展示工程模块与数据流结构。数据从原始输入经过 MILP 建模与求解，输出符合平台规范的 CSV 文件，并通过评分器进行一致性验证。

\input{data/fig_architecture}

\subsection{代码组织}

项目代码按功能模块组织，主要目录结构如下：
\begin{itemize}
\item \texttt{python/meos/}：核心建模与调度模块
\item \texttt{python/scripts/}：可执行脚本入口
\item \texttt{spec/}：设备参数与配置文件
\item \texttt{runs/}：求解结果输出目录
\item \texttt{output/}：最终提交文件目录
\end{itemize}
